{"ast":null,"code":"import _classCallCheck from\"/Users/zhengxinyue/PhpstormProjects/around-web2/around-web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/zhengxinyue/PhpstormProjects/around-web2/around-web/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/zhengxinyue/PhpstormProjects/around-web2/around-web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/zhengxinyue/PhpstormProjects/around-web2/around-web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/zhengxinyue/PhpstormProjects/around-web2/around-web/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import{withScriptjs,withGoogleMap,GoogleMap}from\"react-google-maps\";import{AroundMarker}from'./AroundMarker';import{POS_KEY}from'../constants';var NormalAroundMap=/*#__PURE__*/function(_React$Component){_inherits(NormalAroundMap,_React$Component);function NormalAroundMap(){var _getPrototypeOf2;var _this;_classCallCheck(this,NormalAroundMap);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(NormalAroundMap)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.reloadMarker=function(){var center=_this.getCenter();var radius=_this.getRadius();_this.props.loadPostsByTopic(center,radius);};_this.getMapRef=function(mapInstance){_this.map=mapInstance;window.map=mapInstance;};return _this;}_createClass(NormalAroundMap,[{key:\"getCenter\",value:function getCenter(){var center=this.map.getCenter();return{lat:center.lat(),lon:center.lng()};}},{key:\"getRadius\",value:function getRadius(){var center=this.map.getCenter();var bounds=this.map.getBounds();if(center&&bounds){var ne=bounds.getNorthEast();var right=new window.google.maps.LatLng(center.lat(),ne.lng());return 0.001*window.google.maps.geometry.spherical.computeDistanceBetween(center,right);}}},{key:\"render\",value:function render(){var _JSON$parse=JSON.parse(localStorage.getItem(POS_KEY)),lat=_JSON$parse.lat,lon=_JSON$parse.lon;return React.createElement(GoogleMap,{ref:this.getMapRef,defaultZoom:11,defaultCenter:{lat:lat,lng:lon},onDragEnd:this.reloadMarker,onZoomChanged:this.reloadMarker},this.props.posts.map(function(post){return React.createElement(AroundMarker,{post:post,key:post.url});}));}}]);return NormalAroundMap;}(React.Component);export var AroundMap=withScriptjs(withGoogleMap(NormalAroundMap));","map":{"version":3,"sources":["/Users/zhengxinyue/PhpstormProjects/around-web2/around-web/src/components/AroundMap.js"],"names":["React","withScriptjs","withGoogleMap","GoogleMap","AroundMarker","POS_KEY","NormalAroundMap","reloadMarker","center","getCenter","radius","getRadius","props","loadPostsByTopic","getMapRef","mapInstance","map","window","lat","lon","lng","bounds","getBounds","ne","getNorthEast","right","google","maps","LatLng","geometry","spherical","computeDistanceBetween","JSON","parse","localStorage","getItem","posts","post","url","Component","AroundMap"],"mappings":"+sBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OACIC,YADJ,CAEIC,aAFJ,CAGIC,SAHJ,KAIO,mBAJP,CAKA,OAASC,YAAT,KAA6B,gBAA7B,CACA,OAASC,OAAT,KAAwB,cAAxB,C,GAEMC,CAAAA,e,+aACFC,Y,CAAe,UAAM,CACjB,GAAMC,CAAAA,MAAM,CAAG,MAAKC,SAAL,EAAf,CACA,GAAMC,CAAAA,MAAM,CAAG,MAAKC,SAAL,EAAf,CACA,MAAKC,KAAL,CAAWC,gBAAX,CAA4BL,MAA5B,CAAoCE,MAApC,EACH,C,OAkBDI,S,CAAY,SAACC,WAAD,CAAiB,CACzB,MAAKC,GAAL,CAAWD,WAAX,CACAE,MAAM,CAACD,GAAP,CAAaD,WAAb,CACH,C,wFAnBW,CACR,GAAMP,CAAAA,MAAM,CAAG,KAAKQ,GAAL,CAASP,SAAT,EAAf,CACA,MAAO,CAAES,GAAG,CAAEV,MAAM,CAACU,GAAP,EAAP,CAAqBC,GAAG,CAAEX,MAAM,CAACY,GAAP,EAA1B,CAAP,CACH,C,6CAEW,CACR,GAAMZ,CAAAA,MAAM,CAAG,KAAKQ,GAAL,CAASP,SAAT,EAAf,CACA,GAAMY,CAAAA,MAAM,CAAG,KAAKL,GAAL,CAASM,SAAT,EAAf,CACA,GAAId,MAAM,EAAIa,MAAd,CAAsB,CAClB,GAAME,CAAAA,EAAE,CAAGF,MAAM,CAACG,YAAP,EAAX,CACA,GAAMC,CAAAA,KAAK,CAAG,GAAIR,CAAAA,MAAM,CAACS,MAAP,CAAcC,IAAd,CAAmBC,MAAvB,CAA8BpB,MAAM,CAACU,GAAP,EAA9B,CAA4CK,EAAE,CAACH,GAAH,EAA5C,CAAd,CACA,MAAO,OAAQH,MAAM,CAACS,MAAP,CAAcC,IAAd,CAAmBE,QAAnB,CAA4BC,SAA5B,CAAsCC,sBAAtC,CAA6DvB,MAA7D,CAAqEiB,KAArE,CAAf,CACH,CACJ,C,uCAQQ,iBACgBO,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB9B,OAArB,CAAX,CADhB,CACGa,GADH,aACGA,GADH,CACQC,GADR,aACQA,GADR,CAEL,MACI,qBAAC,SAAD,EACI,GAAG,CAAE,KAAKL,SADd,CAEI,WAAW,CAAE,EAFjB,CAGI,aAAa,CAAE,CAAEI,GAAG,CAAHA,GAAF,CAAOE,GAAG,CAAED,GAAZ,CAHnB,CAII,SAAS,CAAE,KAAKZ,YAJpB,CAKI,aAAa,CAAE,KAAKA,YALxB,EAOK,KAAKK,KAAL,CAAWwB,KAAX,CAAiBpB,GAAjB,CAAqB,SAACqB,IAAD,QAAU,qBAAC,YAAD,EAAc,IAAI,CAAEA,IAApB,CAA0B,GAAG,CAAEA,IAAI,CAACC,GAApC,EAAV,EAArB,CAPL,CADJ,CAWH,C,6BAzCyBtC,KAAK,CAACuC,S,EA4CpC,MAAO,IAAMC,CAAAA,SAAS,CAAGvC,YAAY,CAACC,aAAa,CAACI,eAAD,CAAd,CAA9B","sourcesContent":["import React from 'react';\nimport {\n    withScriptjs,\n    withGoogleMap,\n    GoogleMap,\n} from \"react-google-maps\";\nimport { AroundMarker } from './AroundMarker';\nimport { POS_KEY } from '../constants';\n\nclass NormalAroundMap extends React.Component {\n    reloadMarker = () => {\n        const center = this.getCenter();\n        const radius = this.getRadius();\n        this.props.loadPostsByTopic(center, radius);\n    }\n\n    getCenter() {\n        const center = this.map.getCenter();\n        return { lat: center.lat(), lon: center.lng() };\n    }\n\n    getRadius() {\n        const center = this.map.getCenter();\n        const bounds = this.map.getBounds();\n        if (center && bounds) {\n            const ne = bounds.getNorthEast();\n            const right = new window.google.maps.LatLng(center.lat(), ne.lng());\n            return 0.001 * window.google.maps.geometry.spherical.computeDistanceBetween(center, right);\n        }\n    }\n\n\n    getMapRef = (mapInstance) => {\n        this.map = mapInstance;\n        window.map = mapInstance;\n    }\n\n    render() {\n        const { lat, lon } = JSON.parse(localStorage.getItem(POS_KEY));\n        return (\n            <GoogleMap\n                ref={this.getMapRef}\n                defaultZoom={11}\n                defaultCenter={{ lat, lng: lon }}\n                onDragEnd={this.reloadMarker}\n                onZoomChanged={this.reloadMarker}\n            >\n                {this.props.posts.map((post) => <AroundMarker post={post} key={post.url} />)}\n            </GoogleMap>\n        );\n    }\n}\n\nexport const AroundMap = withScriptjs(withGoogleMap(NormalAroundMap));"]},"metadata":{},"sourceType":"module"}